---
title: "PH1930 Final Project"
author: "Group 2: Yu Bin Chen, Rachit Sabharwal, Caroline Schaefer, Pagna Sok"
date: "2023-12-10"
output:
  html_document: default
  pdf_document: default
---

This report contains results of minimizing the equation using the coordinate descent (CD) and alternating direction method of multipliers (ADMM). Functions are run using C++ code and implemented with the R packages Rcpp and RcppArmadillo: 

\begin{align*}
\frac{1}{2}u^TAu-ub^T+\lambda ||u||_1\\
\end{align*}  


```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(Rcpp)
library(RcppArmadillo)

sourceCpp("coordinate_descent_algo.cpp")
sourceCpp("admm_cpp_v3.cpp")
```
***
# CD Algorithm
## Question 2
#### n = 200, p = 10
```{r}
#set parameters for simulation
rho <- 0.9
n <- 200
p <- 10

#create covariance matrix
cov_matrix <- matrix(0, nrow = p, ncol = p)
for (i in 1:p) {
  for (j in 1:p) {
    cov_matrix[i, j] <- rho^abs(i - j)
  }
}

#simulate data
set.seed(100)  # for reproducibility
X <- MASS::mvrnorm(n = n, mu = rep(0, p), Sigma = cov_matrix)

#set b
b <- c(1, rep(0, p - 1))

#lambda value
lambda <- 0.01

# run CD algorithm
cd <- cg_cd(X, b, lambda, tol=1e-4, maxit = 1000)

print(cd)
```

  
  
## Question 3
#### Vary $\lambda$ from 0.01 to 0.5  

```{r}
lambda_vals <- seq(.01, .5, by=.01)
cd_result <- vector("list", length = length(lambda_vals))

for (i in 1:length(lambda_vals)){
  cd_result[[i]] <- cg_cd(X, b, lambda_vals[i], tol=1e-4, maxit = 1000)
  #print(lambda)
}

print(matrix(unlist(cd_result[c(1:3,48:50)]), ncol=6, byrow=F))
```

***
# ADMM Algorithm
## Question 2
#### n = 200, p = 10
```{r}
#set parameters for simulation
rho <- 0.9
n <- 200
p <- 10

#create covariance matrix
cov_matrix <- matrix(0, nrow = p, ncol = p)
for (i in 1:p) {
  for (j in 1:p) {
    cov_matrix[i, j] <- rho^abs(i - j)
  }
}

#simulate data
set.seed(100)  # for reproducibility
X <- MASS::mvrnorm(n = n, mu = rep(0, p), Sigma = cov_matrix)

#set b
b <- c(1, rep(0, p - 1))

#lambda value
lambda <- 0.01

#ADMM algorithm
admm <- cg_admm(X, b, lambda, tol=1e-4, maxit = 1000)

print(admm)
```
  
  
## Question 3
#### Vary $\lambda$ from 0.01 to 0.5  

```{r}
lambda_vals <- seq(.01, .5, by=.01)
admm_result <- vector("list", length = length(lambda_vals))

for (i in 1:length(lambda_vals)){
  admm_result[[i]] <- cg_admm(X, b, lambda_vals[i], tol=1e-4, maxit = 1000)
  #print(lambda)
}

print(matrix(unlist(admm_result[c(1:3,48:50)]), ncol=6, byrow=F))
```

***
# Comparison: CD and ADMM  
#### Computational Speed
```{r}
#lambda value
lambda <- 0.01
cd_time <- system.time( cg_cd(X, b, lambda, tol=1e-4, maxit = 1000)) 
admm_time <- system.time( cg_admm(X, b, lambda, tol=1e-4, maxit = 1000))

t = list(cd=cd_time, admm=admm_time)
print(t)
```

  
  
#### Accuracy  

```{r}
colnames(cd) = c("CD")
colnames(admm) = c("ADMM")

cbind( b, cd, admm)
```

